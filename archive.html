<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Geist+Mono:wght@100..900&family=Geist:wght@100..900&display=swap" rel="stylesheet">
    
    <title>leftovers - guestbook archiveâœŽ</title>
<link rel="icon" type="image/x-icon" href="/media/marine-arc-emoji-favicon.png">
    
    <link rel="stylesheet" href="style.css">
</head>
<body>

<div class="main-wrapper">
    <h1><a href="https://luckycavity.com/" style="color: #ff0069; font-style:italic; text-decoration:none;">LEFTOVERS</a> / GUESTBOOK ARCHIVEðŸ˜‡ðŸ‘¹</h1>
    
    <p><< <a href="/">BACK TO GUESTBOOK</a></p></h2>
</div>

<div id="gallery">Loading all images...</div>

<script>
  
const GOOGLE_SHEET_ID = "11w2LvZuljHliPFVvejbYIbyd_mXpcWefKuzUa8cVbnI";
const GOOGLE_SHEET_URL = "https://docs.google.com/spreadsheets/d/" + GOOGLE_SHEET_ID + "/export?format=csv";

async function fetchAllImages() {
  try {
    console.log("Fetching from URL:", GOOGLE_SHEET_URL);
    const response = await fetch(GOOGLE_SHEET_URL);
    console.log("Response status:", response.status);
    
    const csvText = await response.text();
    console.log("CSV data received:", csvText);
    
    const rows = csvText.split("\n").slice(1);
    console.log("Rows after splitting:", rows);

    const gallery = document.getElementById("gallery");
    gallery.innerHTML = "";
    
    if (rows.length === 0 || (rows.length === 1 && rows[0].trim() === "")) {
      console.log("No data rows found");
      gallery.innerHTML = "No images submitted yet.";
      return;
    }


      
    // Approved drawings
    const approvedRows = rows.filter(row => {
      const columns = row.split(",");
      // Check if the "Approved" column has stuff
      const approvedStatus = columns[5] ? columns[5].trim().replace(/"/g, "") : "";
      return approvedStatus !== "" && approvedStatus.toLowerCase() !== "no";
    });
    
    // Show all approved images (no limit)
    approvedRows.reverse().forEach((row, index) => {
      console.log(`Processing approved row ${index}:`, row);
      
      const columns = row.split(",");
      console.log("Columns:", columns);
      
      if (columns.length < 2) {
        console.log("Skipping row - not enough columns");
        return;
      }

      const rawTimestamp = columns[0].trim();
      // Timestamp formatting "2025.08.26"
      const date = new Date(rawTimestamp);
      const year = date.getFullYear();
      const month = String(date.getMonth() + 1).padStart(2, '0');
      const day = String(date.getDate()).padStart(2, '0');
      const timestamp = `${year}.${month}.${day}`;

      const imgUrl = columns[1].trim().replace(/"/g, "");
      const artistName = columns[2] ? columns[2].trim().replace(/"/g, "") : "Anonymous";
      const artistWebsite = columns[3] ? columns[3].trim().replace(/"/g, "") : "";
      
      if (imgUrl.startsWith("http")) {
        const div = document.createElement("div");
        div.classList.add("image-container");

        let artistLine = artistName;
        if (artistWebsite && artistWebsite.startsWith("http")) {
          artistLine += ` // <a href="${artistWebsite}" target="_blank">website</a>`;
        }

        div.innerHTML = `
                    <img src="${imgUrl}" alt="drawing by ${artistName}">
                    <p class="artist-line">${artistLine}</p>
                    <p class="timestamp">${timestamp}</p>
                `;
        gallery.appendChild(div);
        console.log("Added approve image to gallery");
      }
    });
    


    
    const totalApproved = gallery.children.length;
    if (totalApproved > 0) {
      const countDiv = document.createElement("div");
      countDiv.style.gridColumn = "1 / -1";
      countDiv.style.textAlign = "center";
      countDiv.style.marginTop = "40px";
      countDiv.style.opacity = "0.6";
      countDiv.innerHTML = `<p>Showing all ${totalApproved} approved drawings</p>`;
      gallery.appendChild(countDiv);
    }
    
  } catch (error) {
    console.error("Error fetching images:", error);
    document.getElementById("gallery").textContent = "Failed to load images.";
  }
}



  
fetchAllImages();
</script>

<div class="main-wrapper">


        <div class="section-header-grid">
                <div class="section-title">
                    <h3>Â© 2025 <a href="https://luckycavity.com/">luckycavity</a> // â™¥ï¸Ž Make your own <a href="https://drawbox.nekoweb.org/">DRAWBOX</a></h3>
                    </div>


            <a href="https://luckycavity.com/"><img style="image-rendering: pixelated;" src="https://left0vers.github.io/button/leftovers-button88x31button-black-border-whitebg-x2.gif" width="88" height="auto"></a> 
            <a href="https://boogerbear.straw.page/"><img style="image-rendering: pixelated;" src="https://left0vers.github.io/button/boogerbearNOW-88x31buttonx2-animated.gif" width="88" height="auto"></a> 
                
        </div>



 </div>

</body>
</html>
